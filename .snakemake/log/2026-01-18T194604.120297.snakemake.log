Assuming unrestricted shared filesystem usage.
host: bioinfo
Building DAG of jobs...
Your conda installation is not configured to use strict channel priorities. This is however important for having robust and correct environments (for details, see https://conda-forge.org/docs/user/tipsandtricks.html). Please consider to configure strict priorities by executing 'conda config --set channel_priority strict'.
Using shell: /usr/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Provided resources: kraken_jobs=1, alignment_jobs=5, iqtree_jobs=3
Job stats:
job                       count
----------------------  -------
all                           1
bam_stats                     2
bcftools_consensus            2
build_probes_index            1
bwa_mapping                   2
download_taxdump              1
extract_unmapped_reads        2
extract_xf_reads              2
fastp                         2
kraken2                       2
mlst_typing                   1
multiqc                       1
recentrifuge                  1
reconstruction_stats          2
summary_reconstruction        1
verify_reconstruction         2
total                        25

Select jobs to execute...
Execute 4 jobs...
[Sun Jan 18 19:46:08 2026]
Job 7: --- [TAXONOMY] Downloading NCBI taxonomy database ---
Reason: Missing output files: 02.tax-classification/tax_dump
Activating conda environment: ../../../tmp/mockdir/conda_envs/50f29b3698e5404d344efee5f51d5ce6_
[Sun Jan 18 19:46:08 2026]
Job 12: --- [MAPPING] BWA: Building probe index ---
Reason: Missing output files: 03.probes_reconstruction/probes.ann, 03.probes_reconstruction/probes.sa, 03.probes_reconstruction/probes.pac, 03.probes_reconstruction/probes.amb, 03.probes_reconstruction/probes.bwt
Activating conda environment: ../../../tmp/mockdir/conda_envs/5edaf1ea88acd7002a4b07a63a9e017c_
[Sun Jan 18 19:46:08 2026]
Job 2: --- [QC] Fastp: Filtering and trimming reads for sample1 ---
Reason: Missing output files: 01.pre-processing/sample1_trim_R2.fastq, 01.pre-processing/sample1_fastp.json, 01.pre-processing/sample1_trim_R1.fastq
Activating conda environment: ../../../tmp/mockdir/conda_envs/f9bbd53c1f2d9e80c5e334f0922e0a7b_
[Sun Jan 18 19:46:08 2026]
Job 3: --- [QC] Fastp: Filtering and trimming reads for sample2-nc ---
Reason: Missing output files: 01.pre-processing/sample2-nc_trim_R1.fastq, 01.pre-processing/sample2-nc_fastp.json, 01.pre-processing/sample2-nc_trim_R2.fastq
Activating conda environment: ../../../tmp/mockdir/conda_envs/f9bbd53c1f2d9e80c5e334f0922e0a7b_
[Sun Jan 18 19:46:08 2026]
Finished jobid: 12 (Rule: build_probes_index)
1 of 25 steps (4%) done
[Sun Jan 18 19:46:23 2026]
Finished jobid: 3 (Rule: fastp)
2 of 25 steps (8%) done
Removing temporary output 01.pre-processing/sample2-nc_fastp.html.
Select jobs to execute...
Execute 1 jobs...
[Sun Jan 18 19:46:23 2026]
Job 6: --- [TAXONOMY] Kraken2: Classifying reads for sample2-nc ---
Reason: Missing output files: 02.tax-classification/sample2-nc.txt, 02.tax-classification/sample2-nc.krk; Input files updated by another job: 01.pre-processing/sample2-nc_trim_R1.fastq, 01.pre-processing/sample2-nc_trim_R2.fastq
Activating conda environment: ../../../tmp/mockdir/conda_envs/50f29b3698e5404d344efee5f51d5ce6_
[Sun Jan 18 19:46:25 2026]
Finished jobid: 6 (Rule: kraken2)
3 of 25 steps (12%) done
Select jobs to execute...
Execute 1 jobs...
[Sun Jan 18 19:46:25 2026]
Job 9: --- [TAXONOMY] Extracting Xylella fastidiosa reads for sample2-nc ---
Reason: Missing output files: 02.tax-classification/xf_taxid_2370/sample2-nc_R1.fastq.gz, 02.tax-classification/xf_taxid_2370/sample2-nc_R2.fastq.gz; Input files updated by another job: 02.tax-classification/sample2-nc.txt, 01.pre-processing/sample2-nc_trim_R1.fastq, 02.tax-classification/sample2-nc.krk, 01.pre-processing/sample2-nc_trim_R2.fastq
Activating conda environment: ../../../tmp/mockdir/conda_envs/50f29b3698e5404d344efee5f51d5ce6_
[Sun Jan 18 19:46:26 2026]
Finished jobid: 2 (Rule: fastp)
4 of 25 steps (16%) done
Removing temporary output 01.pre-processing/sample1_fastp.html.
Select jobs to execute...
Execute 2 jobs...
[Sun Jan 18 19:46:26 2026]
Job 5: --- [TAXONOMY] Kraken2: Classifying reads for sample1 ---
Reason: Missing output files: 02.tax-classification/sample1.txt, 02.tax-classification/sample1.krk; Input files updated by another job: 01.pre-processing/sample1_trim_R2.fastq, 01.pre-processing/sample1_trim_R1.fastq
Activating conda environment: ../../../tmp/mockdir/conda_envs/50f29b3698e5404d344efee5f51d5ce6_
[Sun Jan 18 19:46:26 2026]
Job 1: --- [QC] MultiQC: Aggregating quality control reports ---
Reason: Missing output files: 01.pre-processing/quality_control_report.html; Input files updated by another job: 01.pre-processing/sample1_fastp.json, 01.pre-processing/sample2-nc_fastp.json
Activating conda environment: ../../../tmp/mockdir/conda_envs/f9bbd53c1f2d9e80c5e334f0922e0a7b_
[Sun Jan 18 19:46:27 2026]
Finished jobid: 9 (Rule: extract_xf_reads)
5 of 25 steps (20%) done
Removing temporary output 01.pre-processing/sample2-nc_trim_R1.fastq.
Removing temporary output 01.pre-processing/sample2-nc_trim_R2.fastq.
Removing temporary output 02.tax-classification/sample2-nc.txt.
Select jobs to execute...
Execute 1 jobs...
[Sun Jan 18 19:46:27 2026]
Job 14: --- [MAPPING] BWA: Mapping reads for sample2-nc ---
Reason: Missing output files: 03.probes_reconstruction/sample2-nc_mapped.sorted.bam; Input files updated by another job: 02.tax-classification/xf_taxid_2370/sample2-nc_R1.fastq.gz, 03.probes_reconstruction/probes.pac, 03.probes_reconstruction/probes.ann, 03.probes_reconstruction/probes.sa, 03.probes_reconstruction/probes.amb, 03.probes_reconstruction/probes.bwt, 02.tax-classification/xf_taxid_2370/sample2-nc_R2.fastq.gz
Activating conda environment: ../../../tmp/mockdir/conda_envs/5edaf1ea88acd7002a4b07a63a9e017c_
[Sun Jan 18 19:46:27 2026]
Finished jobid: 14 (Rule: bwa_mapping)
6 of 25 steps (24%) done
Select jobs to execute...
Execute 3 jobs...
[Sun Jan 18 19:46:27 2026]
Job 16: --- [CONSENSUS] BCFtools: Generating consensus for sample2-nc ---
Reason: Missing output files: 03.probes_reconstruction/consensus/sample2-nc_cns.fasta, 03.probes_reconstruction/consensus/sample2-nc_cns_filtered.fasta; Input files updated by another job: 03.probes_reconstruction/sample2-nc_mapped.sorted.bam
Activating conda environment: ../../../tmp/mockdir/conda_envs/5edaf1ea88acd7002a4b07a63a9e017c_
[Sun Jan 18 19:46:27 2026]
Job 13: --- [MAPPING] Samtools: Generating BAM statistics for sample2-nc ---
Reason: Missing output files: 03.probes_reconstruction/stats/sample2-nc_mapped_stats.tsv; Input files updated by another job: 03.probes_reconstruction/sample2-nc_mapped.sorted.bam
Activating conda environment: ../../../tmp/mockdir/conda_envs/5edaf1ea88acd7002a4b07a63a9e017c_
[Sun Jan 18 19:46:27 2026]
Job 21: --- [MAPPING] Extracting unmapped reads for sample2-nc ---
Reason: Missing output files: 03.probes_reconstruction/unmapped/sample2-nc_unmapped_R2.fastq.gz, 03.probes_reconstruction/unmapped/sample2-nc_unmapped_R1.fastq.gz; Input files updated by another job: 03.probes_reconstruction/sample2-nc_mapped.sorted.bam
Activating conda environment: ../../../tmp/mockdir/conda_envs/5edaf1ea88acd7002a4b07a63a9e017c_
[Sun Jan 18 19:46:27 2026]
Finished jobid: 13 (Rule: bam_stats)
7 of 25 steps (28%) done
Removing temporary output 03.probes_reconstruction/sample2-nc_mapped.sorted.bam.bai.
[Sun Jan 18 19:46:27 2026]
Finished jobid: 21 (Rule: extract_unmapped_reads)
8 of 25 steps (32%) done
[Sun Jan 18 19:46:27 2026]
Finished jobid: 16 (Rule: bcftools_consensus)
9 of 25 steps (36%) done
Removing temporary output 03.probes_reconstruction/sample2-nc_mapped.sorted.bam.
Removing temporary output 03.probes_reconstruction/consensus/sample2-nc.vcf.gz.
Removing temporary output 03.probes_reconstruction/consensus/sample2-nc.vcf.gz.csi.
Removing temporary output 03.probes_reconstruction/consensus/sample2-nc_lowcov.bed.
Select jobs to execute...
Execute 2 jobs...
[Sun Jan 18 19:46:27 2026]
Job 24: --- [CHECKPOINT] Verifying reconstruction for sample2-nc ---
Reason: Missing output files: 03.probes_reconstruction/checkpoint/sample2-nc_reconstruction_check.txt; Input files updated by another job: 03.probes_reconstruction/consensus/sample2-nc_cns_filtered.fasta
[Sun Jan 18 19:46:27 2026]
Job 18: --- [STATS] Calculating reconstruction statistics for sample2-nc ---
Reason: Missing output files: 03.probes_reconstruction/stats/sample2-nc_recon_stats.tsv; Input files updated by another job: 03.probes_reconstruction/consensus/sample2-nc_cns.fasta
[Sun Jan 18 19:46:27 2026]
Finished jobid: 24 (Rule: verify_reconstruction)
10 of 25 steps (40%) done
[Sun Jan 18 19:46:27 2026]
Finished jobid: 18 (Rule: reconstruction_stats)
11 of 25 steps (44%) done
[Sun Jan 18 19:46:27 2026]
Finished jobid: 1 (Rule: multiqc)
12 of 25 steps (48%) done
Removing temporary output 01.pre-processing/sample1_fastp.json.
Removing temporary output 01.pre-processing/sample2-nc_fastp.json.
[Sun Jan 18 19:46:28 2026]
Finished jobid: 5 (Rule: kraken2)
13 of 25 steps (52%) done
Select jobs to execute...
Execute 1 jobs...
[Sun Jan 18 19:46:28 2026]
Job 8: --- [TAXONOMY] Extracting Xylella fastidiosa reads for sample1 ---
Reason: Missing output files: 02.tax-classification/xf_taxid_2370/sample1_R1.fastq.gz, 02.tax-classification/xf_taxid_2370/sample1_R2.fastq.gz; Input files updated by another job: 01.pre-processing/sample1_trim_R2.fastq, 01.pre-processing/sample1_trim_R1.fastq, 02.tax-classification/sample1.txt, 02.tax-classification/sample1.krk
Activating conda environment: ../../../tmp/mockdir/conda_envs/50f29b3698e5404d344efee5f51d5ce6_
[Sun Jan 18 19:46:30 2026]
Finished jobid: 8 (Rule: extract_xf_reads)
14 of 25 steps (56%) done
Removing temporary output 01.pre-processing/sample1_trim_R2.fastq.
Removing temporary output 01.pre-processing/sample1_trim_R1.fastq.
Removing temporary output 02.tax-classification/sample1.txt.
Select jobs to execute...
Execute 1 jobs...
[Sun Jan 18 19:46:30 2026]
Job 11: --- [MAPPING] BWA: Mapping reads for sample1 ---
Reason: Missing output files: 03.probes_reconstruction/sample1_mapped.sorted.bam; Input files updated by another job: 02.tax-classification/xf_taxid_2370/sample1_R1.fastq.gz, 03.probes_reconstruction/probes.pac, 03.probes_reconstruction/probes.sa, 03.probes_reconstruction/probes.amb, 03.probes_reconstruction/probes.bwt, 02.tax-classification/xf_taxid_2370/sample1_R2.fastq.gz, 03.probes_reconstruction/probes.ann
Activating conda environment: ../../../tmp/mockdir/conda_envs/5edaf1ea88acd7002a4b07a63a9e017c_
[Sun Jan 18 19:46:31 2026]
Finished jobid: 11 (Rule: bwa_mapping)
15 of 25 steps (60%) done
Removing temporary output 03.probes_reconstruction/probes.ann.
Removing temporary output 03.probes_reconstruction/probes.sa.
Removing temporary output 03.probes_reconstruction/probes.pac.
Removing temporary output 03.probes_reconstruction/probes.amb.
Removing temporary output 03.probes_reconstruction/probes.bwt.
Select jobs to execute...
Execute 3 jobs...
[Sun Jan 18 19:46:31 2026]
Job 15: --- [CONSENSUS] BCFtools: Generating consensus for sample1 ---
Reason: Missing output files: 03.probes_reconstruction/consensus/sample1_cns_filtered.fasta, 03.probes_reconstruction/consensus/sample1_cns.fasta; Input files updated by another job: 03.probes_reconstruction/sample1_mapped.sorted.bam
Activating conda environment: ../../../tmp/mockdir/conda_envs/5edaf1ea88acd7002a4b07a63a9e017c_
[Sun Jan 18 19:46:31 2026]
Job 10: --- [MAPPING] Samtools: Generating BAM statistics for sample1 ---
Reason: Missing output files: 03.probes_reconstruction/stats/sample1_mapped_stats.tsv; Input files updated by another job: 03.probes_reconstruction/sample1_mapped.sorted.bam
Activating conda environment: ../../../tmp/mockdir/conda_envs/5edaf1ea88acd7002a4b07a63a9e017c_
[Sun Jan 18 19:46:31 2026]
Job 20: --- [MAPPING] Extracting unmapped reads for sample1 ---
Reason: Missing output files: 03.probes_reconstruction/unmapped/sample1_unmapped_R1.fastq.gz, 03.probes_reconstruction/unmapped/sample1_unmapped_R2.fastq.gz; Input files updated by another job: 03.probes_reconstruction/sample1_mapped.sorted.bam
Activating conda environment: ../../../tmp/mockdir/conda_envs/5edaf1ea88acd7002a4b07a63a9e017c_
[Sun Jan 18 19:46:32 2026]
Finished jobid: 10 (Rule: bam_stats)
16 of 25 steps (64%) done
Removing temporary output 03.probes_reconstruction/sample1_mapped.sorted.bam.bai.
[Sun Jan 18 19:46:32 2026]
Finished jobid: 20 (Rule: extract_unmapped_reads)
17 of 25 steps (68%) done
[Sun Jan 18 19:46:33 2026]
Finished jobid: 15 (Rule: bcftools_consensus)
18 of 25 steps (72%) done
Removing temporary output 03.probes_reconstruction/sample1_mapped.sorted.bam.
Removing temporary output 03.probes_reconstruction/consensus/sample1.vcf.gz.
Removing temporary output 03.probes_reconstruction/consensus/sample1.vcf.gz.csi.
Removing temporary output 03.probes_reconstruction/consensus/sample1_lowcov.bed.
Select jobs to execute...
Execute 3 jobs...
[Sun Jan 18 19:46:33 2026]
Job 22: --- [MLST] Typing Xylella fastidiosa strains ---
Reason: Missing output files: 04.mlst-typing/mlst_identification.csv; Input files updated by another job: 03.probes_reconstruction/consensus/sample2-nc_cns.fasta, 03.probes_reconstruction/consensus/sample1_cns.fasta
Activating conda environment: ../../../tmp/mockdir/conda_envs/404242276cd17cb1440b4e2a0706ec03_
[Sun Jan 18 19:46:33 2026]
Job 23: --- [CHECKPOINT] Verifying reconstruction for sample1 ---
Reason: Missing output files: 03.probes_reconstruction/checkpoint/sample1_reconstruction_check.txt; Input files updated by another job: 03.probes_reconstruction/consensus/sample1_cns_filtered.fasta
[Sun Jan 18 19:46:33 2026]
Job 17: --- [STATS] Calculating reconstruction statistics for sample1 ---
Reason: Missing output files: 03.probes_reconstruction/stats/sample1_recon_stats.tsv; Input files updated by another job: 03.probes_reconstruction/consensus/sample1_cns.fasta
[Sun Jan 18 19:46:33 2026]
Finished jobid: 23 (Rule: verify_reconstruction)
19 of 25 steps (76%) done
[Sun Jan 18 19:46:33 2026]
Finished jobid: 17 (Rule: reconstruction_stats)
20 of 25 steps (80%) done
Select jobs to execute...
Execute 1 jobs...
[Sun Jan 18 19:46:33 2026]
Job 19: --- [STATS] Generating reconstruction summary report ---
Reason: Missing output files: 03.probes_reconstruction/reconstruction_summary.xlsx; Input files updated by another job: 03.probes_reconstruction/stats/sample1_recon_stats.tsv, 03.probes_reconstruction/stats/sample2-nc_mapped_stats.tsv, 03.probes_reconstruction/stats/sample2-nc_recon_stats.tsv, 03.probes_reconstruction/stats/sample1_mapped_stats.tsv
Activating conda environment: ../../../tmp/mockdir/conda_envs/28605af84616f24f061c456845e63215_
[Sun Jan 18 19:46:34 2026]
Finished jobid: 22 (Rule: mlst_typing)
21 of 25 steps (84%) done
[Sun Jan 18 19:46:36 2026]
Finished jobid: 19 (Rule: summary_reconstruction)
22 of 25 steps (88%) done
RuleException:
CalledProcessError in file "/home/luisagi/github/XfCapture/Snakefile", line 260:
Command 'source /home/luisagi/miniconda3/bin/activate '/home/luisagi/tmp/mockdir/conda_envs/50f29b3698e5404d344efee5f51d5ce6_'; set -euo pipefail;  
        retaxdump --nodespath 02.tax-classification/tax_dump > logs/download_taxdump.log 2>&1
        rm -f taxdmp.zip' returned non-zero exit status 1.
[Sun Jan 18 19:48:56 2026]
Error in rule download_taxdump:
    message: None
    jobid: 7
    output: 02.tax-classification/tax_dump
    log: logs/download_taxdump.log (check log file(s) for error details)
    conda-env: /home/luisagi/tmp/mockdir/conda_envs/50f29b3698e5404d344efee5f51d5ce6_
    shell:
        
        retaxdump --nodespath 02.tax-classification/tax_dump > logs/download_taxdump.log 2>&1
        rm -f taxdmp.zip
        
        (command exited with non-zero exit code)
Removing output files of failed job download_taxdump since they might be corrupted:
02.tax-classification/tax_dump
Shutting down, this might take some time.
Exiting because a job execution failed. Look below for error messages
[Sun Jan 18 19:48:56 2026]
Error in rule download_taxdump:
    message: None
    jobid: 7
    output: 02.tax-classification/tax_dump
    log: logs/download_taxdump.log (check log file(s) for error details)
    conda-env: /home/luisagi/tmp/mockdir/conda_envs/50f29b3698e5404d344efee5f51d5ce6_
    shell:
        
        retaxdump --nodespath 02.tax-classification/tax_dump > logs/download_taxdump.log 2>&1
        rm -f taxdmp.zip
        
        (command exited with non-zero exit code)
Complete log(s): /home/luisagi/github/XfCapture/.snakemake/log/2026-01-18T194604.120297.snakemake.log
WorkflowError:
At least one job did not complete successfully.
